{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL is not set. Configure a Postgres connection string.\");\n}\n\nconst globalForPrisma = global as typeof global & {\n  prisma?: PrismaClient;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: process.env.NODE_ENV === \"development\" ? [\"error\"] : [\"error\"],\n  });\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n"],"names":[],"mappings":";;;;AAAA;;AACA,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC7B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM;AAIC,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;KAAQ,GAAG;AAC5D;AAEF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/brand.ts"],"sourcesContent":["export const brand = {\n  name: \"Lucien\",\n  wordmark: \"LUCIEN\",\n  domain: \"lucien.technology\",\n  email: \"company@lucien.technology\",\n  governingLaw: \"Jurisdiction TBD\",\n  colors: {\n    nearBlack: \"#0F0F10\",\n    softWhite: \"#FAFAFA\",\n  },\n};\n"],"names":[],"mappings":";;;;AAAO,MAAM,QAAQ;IACnB,MAAM;IACN,UAAU;IACV,QAAQ;IACR,OAAO;IACP,cAAc;IACd,QAAQ;QACN,WAAW;QACX,WAAW;IACb;AACF"}},
    {"offset": {"line": 195, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/audit.ts"],"sourcesContent":["import { prisma } from \"@/lib/prisma\";\n\nexport type AuditInput = {\n  orgId: string;\n  action: string;\n  resourceType: string;\n  resourceId?: string | null;\n  userId?: string | null;\n  meta?: Record<string, unknown> | null;\n  ip?: string | null;\n  userAgent?: string | null;\n};\n\nexport async function logAuditEvent({\n  orgId,\n  action,\n  resourceType,\n  resourceId,\n  userId,\n  meta,\n  ip,\n  userAgent,\n}: AuditInput) {\n  try {\n    await prisma.auditEvent.create({\n      data: {\n        orgId,\n        action,\n        resourceType,\n        resourceId: resourceId ?? null,\n        userId: userId ?? null,\n        metaJson: meta ? JSON.stringify(meta) : null,\n        ip: ip ?? null,\n        userAgent: userAgent ?? null,\n      },\n    });\n  } catch (error) {\n    console.error(\"AuditEventFailed\", error);\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAaO,eAAe,cAAc,EAClC,KAAK,EACL,MAAM,EACN,YAAY,EACZ,UAAU,EACV,MAAM,EACN,IAAI,EACJ,EAAE,EACF,SAAS,EACE;IACX,IAAI;QACF,MAAM,yHAAM,CAAC,UAAU,CAAC,MAAM,CAAC;YAC7B,MAAM;gBACJ;gBACA;gBACA;gBACA,YAAY,cAAc;gBAC1B,QAAQ,UAAU;gBAClB,UAAU,OAAO,KAAK,SAAS,CAAC,QAAQ;gBACxC,IAAI,MAAM;gBACV,WAAW,aAAa;YAC1B;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oBAAoB;IACpC;AACF"}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/org.ts"],"sourcesContent":["import { prisma } from \"@/lib/prisma\";\n\nexport function getDomainFromEmail(email: string) {\n  const [, domain] = email.toLowerCase().split(\"@\");\n  return domain ?? null;\n}\n\ntype OrgInput = {\n  name: string;\n  domain?: string | null;\n};\n\nexport async function getOrCreateOrg({ name, domain }: OrgInput) {\n  if (domain) {\n    const existing = await prisma.org.findFirst({ where: { domain } });\n    if (existing) {\n      return existing;\n    }\n  }\n\n  const existingByName = await prisma.org.findUnique({ where: { name } });\n  if (existingByName) {\n    if (!existingByName.domain && domain) {\n      return prisma.org.update({\n        where: { id: existingByName.id },\n        data: { domain },\n      });\n    }\n    return existingByName;\n  }\n\n  return prisma.org.create({\n    data: {\n      name,\n      domain: domain ?? undefined,\n    },\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,SAAS,mBAAmB,KAAa;IAC9C,MAAM,GAAG,OAAO,GAAG,MAAM,WAAW,GAAG,KAAK,CAAC;IAC7C,OAAO,UAAU;AACnB;AAOO,eAAe,eAAe,EAAE,IAAI,EAAE,MAAM,EAAY;IAC7D,IAAI,QAAQ;QACV,MAAM,WAAW,MAAM,yHAAM,CAAC,GAAG,CAAC,SAAS,CAAC;YAAE,OAAO;gBAAE;YAAO;QAAE;QAChE,IAAI,UAAU;YACZ,OAAO;QACT;IACF;IAEA,MAAM,iBAAiB,MAAM,yHAAM,CAAC,GAAG,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE;QAAK;IAAE;IACrE,IAAI,gBAAgB;QAClB,IAAI,CAAC,eAAe,MAAM,IAAI,QAAQ;YACpC,OAAO,yHAAM,CAAC,GAAG,CAAC,MAAM,CAAC;gBACvB,OAAO;oBAAE,IAAI,eAAe,EAAE;gBAAC;gBAC/B,MAAM;oBAAE;gBAAO;YACjB;QACF;QACA,OAAO;IACT;IAEA,OAAO,yHAAM,CAAC,GAAG,CAAC,MAAM,CAAC;QACvB,MAAM;YACJ;YACA,QAAQ,UAAU;QACpB;IACF;AACF"}},
    {"offset": {"line": 275, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/auth-helpers.ts"],"sourcesContent":["export function getDevLoginEmails() {\n  if (process.env.NODE_ENV !== \"development\") {\n    return [];\n  }\n\n  const fallback =\n    process.env.DEV_LOGIN_EMAIL ||\n    process.env.ADMIN_EMAIL ||\n    \"admin@lucien.technology\";\n\n  return fallback\n    .split(\",\")\n    .map((email) => email.trim().toLowerCase())\n    .filter(Boolean);\n}\n"],"names":[],"mappings":";;;;AAAO,SAAS;IACd;;IAIA,MAAM,WACJ,QAAQ,GAAG,CAAC,eAAe,IAC3B,QAAQ,GAAG,CAAC,WAAW,IACvB;IAEF,OAAO,SACJ,KAAK,CAAC,KACN,GAAG,CAAC,CAAC,QAAU,MAAM,IAAI,GAAG,WAAW,IACvC,MAAM,CAAC;AACZ"}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/auth.ts"],"sourcesContent":["import type { NextAuthOptions } from \"next-auth\";\nimport { getServerSession } from \"next-auth\";\nimport EmailProvider from \"next-auth/providers/email\";\nimport type { SendVerificationRequestParams } from \"next-auth/providers/email\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\nimport { PrismaAdapter } from \"@auth/prisma-adapter\";\nimport { createTransport } from \"nodemailer\";\nimport type { TransportOptions } from \"nodemailer\";\nimport { prisma } from \"@/lib/prisma\";\nimport { brand } from \"@/lib/brand\";\nimport { logAuditEvent } from \"@/lib/audit\";\nimport { getDomainFromEmail, getOrCreateOrg } from \"@/lib/org\";\nimport { getDevLoginEmails } from \"@/lib/auth-helpers\";\n\nconst devLoginEmails = getDevLoginEmails();\n\nif (process.env.NODE_ENV === \"development\") {\n  if (!process.env.NEXTAUTH_URL) {\n    process.env.NEXTAUTH_URL = \"http://localhost:3000\";\n  }\n  if (!process.env.NEXTAUTH_SECRET) {\n    process.env.NEXTAUTH_SECRET = \"dev-secret-change-me\";\n  }\n}\n\nasync function sendMagicLink(params: SendVerificationRequestParams) {\n  const { identifier, url, provider } = params;\n\n  if (!provider.server) {\n    if (process.env.NODE_ENV === \"development\") {\n      console.info(\"DevMagicLink\", { email: identifier, url });\n      return;\n    }\n    throw new Error(\"EMAIL_SERVER is not configured.\");\n  }\n\n  const transport = createTransport(provider.server as TransportOptions | string);\n  const fromAddress = provider.from ?? brand.email;\n\n  await transport.sendMail({\n    to: identifier,\n    from: fromAddress,\n    subject: `Sign in to ${brand.wordmark}`,\n    text: `Use this link to sign in: ${url}`,\n    html: `<p>Use this link to sign in:</p><p><a href=\"${url}\">${url}</a></p>`,\n  });\n}\n\nconst adapter = PrismaAdapter(prisma);\nadapter.createUser = async (data) => {\n  const email = data.email.toLowerCase();\n  const domain = getDomainFromEmail(email);\n  const isLucien = email.includes(\"lucien\");\n  const orgName = isLucien ? \"Lucien Internal\" : domain ?? \"Client Workspace\";\n  const org = await getOrCreateOrg({ name: orgName, domain });\n  const role =\n    isLucien && (email.startsWith(\"ops@\") || email.startsWith(\"operator@\"))\n      ? \"lucien_operator\"\n      : isLucien\n        ? \"lucien_admin\"\n        : \"org_user\";\n\n  return prisma.user.create({\n    data: {\n      email,\n      name: data.name,\n      emailVerified: data.emailVerified,\n      role,\n      orgId: org.id,\n    },\n  });\n};\n\nexport const authOptions: NextAuthOptions = {\n  adapter,\n  secret: process.env.NEXTAUTH_SECRET,\n  pages: {\n    signIn: \"/login\",\n  },\n  session: {\n    strategy: \"jwt\",\n  },\n  providers: [\n    EmailProvider({\n      server: process.env.EMAIL_SERVER,\n      from: process.env.EMAIL_FROM ?? brand.email,\n      sendVerificationRequest: sendMagicLink,\n    }),\n    ...(process.env.NODE_ENV === \"development\" && devLoginEmails.length > 0\n      ? [\n          CredentialsProvider({\n            id: \"dev-login\",\n            name: \"Dev Login\",\n            credentials: {\n              email: { label: \"Email\", type: \"text\" },\n            },\n            async authorize(credentials) {\n              const email = credentials?.email?.toLowerCase();\n              if (!email || !devLoginEmails.includes(email)) {\n                return null;\n              }\n\n              const domain = getDomainFromEmail(email);\n              const isLucien = email.includes(\"lucien\");\n              const orgName = isLucien\n                ? \"Lucien Internal\"\n                : \"Client Workspace\";\n              const org = await getOrCreateOrg({ name: orgName, domain });\n\n              const role = isLucien\n                ? email.startsWith(\"ops@\") || email.startsWith(\"operator@\")\n                  ? \"lucien_operator\"\n                  : \"lucien_admin\"\n                : email.startsWith(\"admin@\")\n                  ? \"org_admin\"\n                  : \"org_user\";\n\n              const user = await prisma.user.upsert({\n                where: { email },\n                update: {\n                  role,\n                  orgId: org.id,\n                  lastLoginAt: new Date(),\n                },\n                create: {\n                  email,\n                  role,\n                  orgId: org.id,\n                  name: email.split(\"@\")[0],\n                  lastLoginAt: new Date(),\n                },\n              });\n\n              await logAuditEvent({\n                orgId: org.id,\n                userId: user.id,\n                action: \"login\",\n                resourceType: \"user\",\n                resourceId: user.id,\n                meta: { source: \"dev-login\" },\n              });\n\n              return user;\n            },\n          }),\n        ]\n      : []),\n  ],\n  callbacks: {\n    async session({ session, token, user }) {\n      if (session.user) {\n        session.user.id = user?.id ?? (token.sub as string | undefined);\n        session.user.role = (user?.role ?? token.role) as string | undefined;\n        session.user.orgId = (user?.orgId ?? token.orgId) as string | undefined;\n      }\n      return session;\n    },\n    async jwt({ token, user }) {\n      if (user) {\n        token.role = user.role;\n        token.orgId = user.orgId;\n      }\n      return token;\n    },\n  },\n  events: {\n    async signIn({ user }) {\n      if (!user?.id || !user.orgId) {\n        return;\n      }\n      await prisma.user.update({\n        where: { id: user.id },\n        data: { lastLoginAt: new Date() },\n      });\n      await logAuditEvent({\n        orgId: user.orgId,\n        userId: user.id,\n        action: \"login\",\n        resourceType: \"user\",\n        resourceId: user.id,\n        meta: { source: \"email\" },\n      });\n    },\n    async signOut({ session }) {\n      const userId = session?.user?.id;\n      const orgId = session?.user?.orgId;\n      if (!userId || !orgId) {\n        return;\n      }\n      await logAuditEvent({\n        orgId,\n        userId,\n        action: \"logout\",\n        resourceType: \"user\",\n        resourceId: userId,\n      });\n    },\n  },\n};\n\nexport function getServerAuthSession() {\n  return getServerSession(authOptions);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/lib/rateLimit.ts"],"sourcesContent":["const rateLimitStore = new Map<string, { count: number; resetAt: number }>();\n\nexport type RateLimitResult = {\n  allowed: boolean;\n  remaining: number;\n  resetAt: number;\n};\n\ntype RateLimitOptions = {\n  windowMs: number;\n  max: number;\n};\n\nexport function getClientIp(request: Request) {\n  const forwarded = request.headers.get(\"x-forwarded-for\");\n  const realIp = request.headers.get(\"x-real-ip\");\n  const cfIp = request.headers.get(\"cf-connecting-ip\");\n  return (forwarded || realIp || cfIp || \"unknown\").split(\",\")[0]?.trim();\n}\n\nexport function rateLimit(key: string, options: RateLimitOptions): RateLimitResult {\n  const now = Date.now();\n  const bucket = rateLimitStore.get(key);\n\n  if (!bucket || bucket.resetAt < now) {\n    const resetAt = now + options.windowMs;\n    rateLimitStore.set(key, { count: 1, resetAt });\n    return { allowed: true, remaining: options.max - 1, resetAt };\n  }\n\n  if (bucket.count >= options.max) {\n    return { allowed: false, remaining: 0, resetAt: bucket.resetAt };\n  }\n\n  bucket.count += 1;\n  rateLimitStore.set(key, bucket);\n  return {\n    allowed: true,\n    remaining: options.max - bucket.count,\n    resetAt: bucket.resetAt,\n  };\n}\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,iBAAiB,IAAI;AAapB,SAAS,YAAY,OAAgB;IAC1C,MAAM,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC;IACtC,MAAM,SAAS,QAAQ,OAAO,CAAC,GAAG,CAAC;IACnC,MAAM,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC;IACjC,OAAO,CAAC,aAAa,UAAU,QAAQ,SAAS,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE;AACnE;AAEO,SAAS,UAAU,GAAW,EAAE,OAAyB;IAC9D,MAAM,MAAM,KAAK,GAAG;IACpB,MAAM,SAAS,eAAe,GAAG,CAAC;IAElC,IAAI,CAAC,UAAU,OAAO,OAAO,GAAG,KAAK;QACnC,MAAM,UAAU,MAAM,QAAQ,QAAQ;QACtC,eAAe,GAAG,CAAC,KAAK;YAAE,OAAO;YAAG;QAAQ;QAC5C,OAAO;YAAE,SAAS;YAAM,WAAW,QAAQ,GAAG,GAAG;YAAG;QAAQ;IAC9D;IAEA,IAAI,OAAO,KAAK,IAAI,QAAQ,GAAG,EAAE;QAC/B,OAAO;YAAE,SAAS;YAAO,WAAW;YAAG,SAAS,OAAO,OAAO;QAAC;IACjE;IAEA,OAAO,KAAK,IAAI;IAChB,eAAe,GAAG,CAAC,KAAK;IACxB,OAAO;QACL,SAAS;QACT,WAAW,QAAQ,GAAG,GAAG,OAAO,KAAK;QACrC,SAAS,OAAO,OAAO;IACzB;AACF"}},
    {"offset": {"line": 549, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport type { NextRequest } from \"next/server\";\nimport { NextResponse } from \"next/server\";\nimport { authOptions } from \"@/lib/auth\";\nimport { getClientIp, rateLimit } from \"@/lib/rateLimit\";\n\nconst authRateLimit = {\n  windowMs: 10 * 60 * 1000,\n  max: 20,\n};\n\nconst handler = NextAuth(authOptions);\n\nasync function enforceRateLimit(request: Request) {\n  if (process.env.NODE_ENV !== \"production\") {\n    return null;\n  }\n  const clientIp = getClientIp(request);\n  const result = rateLimit(`auth:${clientIp}`, authRateLimit);\n  if (!result.allowed) {\n    return NextResponse.json({ ok: false }, { status: 429 });\n  }\n  return null;\n}\n\nexport async function GET(\n  request: NextRequest,\n  context: { params: Promise<{ nextauth: string[] }> },\n) {\n  const limited = await enforceRateLimit(request);\n  if (limited) {\n    return limited;\n  }\n  return handler(request, context as never);\n}\n\nexport async function POST(\n  request: NextRequest,\n  context: { params: Promise<{ nextauth: string[] }> },\n) {\n  const limited = await enforceRateLimit(request);\n  if (limited) {\n    return limited;\n  }\n  return handler(request, context as never);\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAEA;AACA;AACA;;;;;AAEA,MAAM,gBAAgB;IACpB,UAAU,KAAK,KAAK;IACpB,KAAK;AACP;AAEA,MAAM,UAAU,IAAA,kJAAQ,EAAC,4HAAW;AAEpC,eAAe,iBAAiB,OAAgB;IAC9C,wCAA2C;QACzC,OAAO;IACT;;;IACA,MAAM;IACN,MAAM;AAKR;AAEO,eAAe,IACpB,OAAoB,EACpB,OAAoD;IAEpD,MAAM,UAAU,MAAM,iBAAiB;IACvC,IAAI,SAAS;QACX,OAAO;IACT;IACA,OAAO,QAAQ,SAAS;AAC1B;AAEO,eAAe,KACpB,OAAoB,EACpB,OAAoD;IAEpD,MAAM,UAAU,MAAM,iBAAiB;IACvC,IAAI,SAAS;QACX,OAAO;IACT;IACA,OAAO,QAAQ,SAAS;AAC1B"}}]
}