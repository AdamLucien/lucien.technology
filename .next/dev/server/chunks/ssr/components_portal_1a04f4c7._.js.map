{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/components/portal/DocumentUploader.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Icon } from \"@/components/icons/Icon\";\n\nconst categories = [\n  \"nda\",\n  \"sow\",\n  \"contract\",\n  \"deliverable\",\n  \"report\",\n  \"invoice\",\n  \"client_input\",\n  \"evidence\",\n  \"other\",\n];\n\ntype DocumentUploaderProps = {\n  engagementId: string;\n  allowedCategories?: string[];\n  accept?: string;\n};\n\nexport function DocumentUploader({\n  engagementId,\n  allowedCategories,\n  accept,\n}: DocumentUploaderProps) {\n  const [status, setStatus] = useState<\"idle\" | \"loading\" | \"success\" | \"error\">(\n    \"idle\",\n  );\n  const [message, setMessage] = useState<string | null>(null);\n\n  const onSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    setStatus(\"loading\");\n    setMessage(null);\n\n    const formData = new FormData(event.currentTarget);\n    formData.set(\"engagementId\", engagementId);\n\n    try {\n      const response = await fetch(\"/api/portal/documents\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (response.ok) {\n        setStatus(\"success\");\n        setMessage(\"Document uploaded.\");\n        event.currentTarget.reset();\n      } else {\n        const data = await response.json().catch(() => null);\n        setStatus(\"error\");\n        setMessage(data?.error ?? \"Upload failed.\");\n      }\n    } catch {\n      setStatus(\"error\");\n      setMessage(\"Upload failed.\");\n    }\n  };\n\n  return (\n    <form\n      onSubmit={onSubmit}\n      className=\"space-y-3 rounded-2xl border border-line/80 bg-ink p-4 text-sm text-muted\"\n    >\n      <div className=\"text-xs uppercase tracking-[0.2em] text-slate\">\n        Upload document\n      </div>\n      <div className=\"grid gap-3 md:grid-cols-[1fr_auto]\">\n        <input\n          type=\"file\"\n          name=\"file\"\n          required\n          accept={accept}\n          className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n        />\n        <select\n          name=\"category\"\n          className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n          defaultValue={(allowedCategories ?? categories)[0]}\n        >\n          {(allowedCategories ?? categories).map((category) => (\n            <option key={category} value={category}>\n              {category.toUpperCase()}\n            </option>\n          ))}\n        </select>\n      </div>\n      <button\n        type=\"submit\"\n        disabled={status === \"loading\"}\n        className=\"btn-animate btn-primary inline-flex items-center gap-2 rounded-full px-4 py-2 text-xs uppercase tracking-[0.2em]\"\n      >\n        <Icon name=\"upload\" size={16} strokeWidth={1.25} entrance={false} />\n        {status === \"loading\" ? \"Uploading\" : \"Upload\"}\n      </button>\n      {message && (\n        <p\n          className={`text-xs ${\n            status === \"error\" ? \"text-[#E5A4A4]\" : \"text-ash\"\n          }`}\n        >\n          {message}\n        </p>\n      )}\n    </form>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKA,MAAM,aAAa;IACjB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAQM,SAAS,iBAAiB,EAC/B,YAAY,EACZ,iBAAiB,EACjB,MAAM,EACgB;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAClC;IAEF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAgB;IAEtD,MAAM,WAAW,OAAO;QACtB,MAAM,cAAc;QACpB,UAAU;QACV,WAAW;QAEX,MAAM,WAAW,IAAI,SAAS,MAAM,aAAa;QACjD,SAAS,GAAG,CAAC,gBAAgB;QAE7B,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,yBAAyB;gBACpD,QAAQ;gBACR,MAAM;YACR;YAEA,IAAI,SAAS,EAAE,EAAE;gBACf,UAAU;gBACV,WAAW;gBACX,MAAM,aAAa,CAAC,KAAK;YAC3B,OAAO;gBACL,MAAM,OAAO,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM;gBAC/C,UAAU;gBACV,WAAW,MAAM,SAAS;YAC5B;QACF,EAAE,OAAM;YACN,UAAU;YACV,WAAW;QACb;IACF;IAEA,qBACE,8OAAC;QACC,UAAU;QACV,WAAU;;0BAEV,8OAAC;gBAAI,WAAU;0BAAgD;;;;;;0BAG/D,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,MAAK;wBACL,QAAQ;wBACR,QAAQ;wBACR,WAAU;;;;;;kCAEZ,8OAAC;wBACC,MAAK;wBACL,WAAU;wBACV,cAAc,CAAC,qBAAqB,UAAU,CAAC,CAAC,EAAE;kCAEjD,CAAC,qBAAqB,UAAU,EAAE,GAAG,CAAC,CAAC,yBACtC,8OAAC;gCAAsB,OAAO;0CAC3B,SAAS,WAAW;+BADV;;;;;;;;;;;;;;;;0BAMnB,8OAAC;gBACC,MAAK;gBACL,UAAU,WAAW;gBACrB,WAAU;;kCAEV,8OAAC,oIAAI;wBAAC,MAAK;wBAAS,MAAM;wBAAI,aAAa;wBAAM,UAAU;;;;;;oBAC1D,WAAW,YAAY,cAAc;;;;;;;YAEvC,yBACC,8OAAC;gBACC,WAAW,CAAC,QAAQ,EAClB,WAAW,UAAU,mBAAmB,YACxC;0BAED;;;;;;;;;;;;AAKX"}},
    {"offset": {"line": 144, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/components/portal/EngagementEditPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { useMemo, useState } from \"react\";\nimport { Icon } from \"@/components/icons/Icon\";\n\ntype OwnerOption = { id: string; label: string };\n\ntype EngagementEditPanelProps = {\n  engagementId: string;\n  initialTitle: string;\n  initialOwnerId?: string | null;\n  initialStartDate?: string | null;\n  initialTargetDate?: string | null;\n  initialProcurementRef?: string | null;\n  initialPurchaseOrderRef?: string | null;\n  initialCostCenter?: string | null;\n  ownerOptions: OwnerOption[];\n  isStaff: boolean;\n};\n\ntype DiffEntry = { field: string; from: unknown; to: unknown };\n\nconst criticalFields = new Set([\"procurementRef\", \"purchaseOrderRef\", \"costCenter\"]);\n\nexport function EngagementEditPanel({\n  engagementId,\n  initialTitle,\n  initialOwnerId,\n  initialStartDate,\n  initialTargetDate,\n  initialProcurementRef,\n  initialPurchaseOrderRef,\n  initialCostCenter,\n  ownerOptions,\n  isStaff,\n}: EngagementEditPanelProps) {\n  const [open, setOpen] = useState(false);\n  const [title, setTitle] = useState(initialTitle);\n  const [ownerId, setOwnerId] = useState(initialOwnerId ?? \"\");\n  const [startDate, setStartDate] = useState(initialStartDate ?? \"\");\n  const [targetDate, setTargetDate] = useState(initialTargetDate ?? \"\");\n  const [procurementRef, setProcurementRef] = useState(\n    initialProcurementRef ?? \"\",\n  );\n  const [purchaseOrderRef, setPurchaseOrderRef] = useState(\n    initialPurchaseOrderRef ?? \"\",\n  );\n  const [costCenter, setCostCenter] = useState(initialCostCenter ?? \"\");\n  const [reason, setReason] = useState(\"\");\n  const [status, setStatus] = useState<\"idle\" | \"loading\" | \"success\" | \"error\">(\n    \"idle\",\n  );\n  const [message, setMessage] = useState<string | null>(null);\n  const [editEventId, setEditEventId] = useState<string | null>(null);\n  const [requiresCr, setRequiresCr] = useState(false);\n\n  const diff = useMemo(() => {\n    const entries: DiffEntry[] = [];\n    if (title.trim() !== initialTitle) {\n      entries.push({ field: \"title\", from: initialTitle, to: title.trim() });\n    }\n    if (ownerId !== (initialOwnerId ?? \"\")) {\n      entries.push({\n        field: \"ownerId\",\n        from: initialOwnerId ?? null,\n        to: ownerId || null,\n      });\n    }\n    if (startDate !== (initialStartDate ?? \"\")) {\n      entries.push({\n        field: \"startDate\",\n        from: initialStartDate ?? null,\n        to: startDate || null,\n      });\n    }\n    if (targetDate !== (initialTargetDate ?? \"\")) {\n      entries.push({\n        field: \"targetDate\",\n        from: initialTargetDate ?? null,\n        to: targetDate || null,\n      });\n    }\n    if (procurementRef !== (initialProcurementRef ?? \"\")) {\n      entries.push({\n        field: \"procurementRef\",\n        from: initialProcurementRef ?? null,\n        to: procurementRef || null,\n      });\n    }\n    if (purchaseOrderRef !== (initialPurchaseOrderRef ?? \"\")) {\n      entries.push({\n        field: \"purchaseOrderRef\",\n        from: initialPurchaseOrderRef ?? null,\n        to: purchaseOrderRef || null,\n      });\n    }\n    if (costCenter !== (initialCostCenter ?? \"\")) {\n      entries.push({\n        field: \"costCenter\",\n        from: initialCostCenter ?? null,\n        to: costCenter || null,\n      });\n    }\n    return entries;\n  }, [\n    title,\n    ownerId,\n    startDate,\n    targetDate,\n    procurementRef,\n    purchaseOrderRef,\n    costCenter,\n    initialTitle,\n    initialOwnerId,\n    initialStartDate,\n    initialTargetDate,\n    initialProcurementRef,\n    initialPurchaseOrderRef,\n    initialCostCenter,\n  ]);\n\n  const changeRequestLink = useMemo(() => {\n    if (!editEventId) return \"/portal/change-requests\";\n    const summary = diff\n      .map((entry) => `${entry.field}: ${entry.from ?? \"—\"} → ${entry.to ?? \"—\"}`)\n      .join(\"; \");\n    const params = new URLSearchParams({\n      title: `Change request for ${initialTitle}`,\n      description: `Requested edit: ${summary}`,\n      editEventId,\n    });\n    return `/portal/change-requests?${params.toString()}`;\n  }, [diff, editEventId, initialTitle]);\n\n  const onSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    if (!isStaff && diff.length === 0) {\n      setMessage(\"No changes detected.\");\n      setStatus(\"error\");\n      return;\n    }\n    if (diff.length === 0) {\n      setMessage(\"No changes detected.\");\n      setStatus(\"error\");\n      return;\n    }\n    if (reason.trim().length < 5) {\n      setMessage(\"Provide a short reason for the change.\");\n      setStatus(\"error\");\n      return;\n    }\n\n    setStatus(\"loading\");\n    setMessage(null);\n    setRequiresCr(diff.some((entry) => criticalFields.has(entry.field)));\n\n    try {\n      const response = await fetch(\"/api/portal/edits\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          entityType: \"engagement\",\n          entityId: engagementId,\n          reason: reason.trim(),\n          diff,\n        }),\n      });\n\n      const data = await response.json().catch(() => null);\n      if (!response.ok) {\n        setStatus(\"error\");\n        setMessage(data?.error ?? \"Update failed.\");\n        return;\n      }\n      setStatus(\"success\");\n      setEditEventId(data?.editEventId ?? null);\n      if (data?.status === \"pending_approval\") {\n        setRequiresCr(true);\n        setMessage(\n          \"This change requires approval via a Change Request before it can be applied.\",\n        );\n      } else {\n        setMessage(\"Update applied.\");\n      }\n    } catch {\n      setStatus(\"error\");\n      setMessage(\"Update failed.\");\n    }\n  };\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        onClick={() => setOpen(true)}\n        className=\"btn-animate btn-secondary inline-flex items-center gap-2 rounded-full px-4 py-2 text-xs uppercase tracking-[0.2em]\"\n      >\n        <Icon name=\"edit\" size={16} strokeWidth={1.25} entrance={false} />\n        Edit details\n      </button>\n      {open && (\n        <div className=\"fixed inset-0 z-50 flex justify-end\">\n          <div\n            className=\"absolute inset-0 bg-ink/80 backdrop-blur\"\n            onClick={() => setOpen(false)}\n          />\n          <div className=\"relative h-full w-full max-w-md border-l border-line/80 bg-ink p-6\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"flex items-center gap-2 text-sm uppercase tracking-[0.2em] text-slate\">\n                <Icon name=\"edit\" size={16} strokeWidth={1.25} entrance={false} />\n                Edit engagement\n              </h2>\n              <button\n                type=\"button\"\n                onClick={() => setOpen(false)}\n                className=\"text-xs uppercase tracking-[0.2em] text-slate\"\n              >\n                Close\n              </button>\n            </div>\n\n            <form onSubmit={onSubmit} className=\"mt-6 space-y-4 text-sm text-slate\">\n              <label className=\"space-y-2\">\n                Title\n                <input\n                  value={title}\n                  onChange={(event) => setTitle(event.target.value)}\n                  className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                />\n              </label>\n              {isStaff && (\n                <>\n                  <label className=\"space-y-2\">\n                    Owner\n                    <select\n                      value={ownerId}\n                      onChange={(event) => setOwnerId(event.target.value)}\n                      className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                    >\n                      <option value=\"\">Unassigned</option>\n                      {ownerOptions.map((owner) => (\n                        <option key={owner.id} value={owner.id}>\n                          {owner.label}\n                        </option>\n                      ))}\n                    </select>\n                  </label>\n                  <label className=\"space-y-2\">\n                    Start date\n                    <input\n                      type=\"date\"\n                      value={startDate}\n                      onChange={(event) => setStartDate(event.target.value)}\n                      className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                    />\n                  </label>\n                  <label className=\"space-y-2\">\n                    Target date\n                    <input\n                      type=\"date\"\n                      value={targetDate}\n                      onChange={(event) => setTargetDate(event.target.value)}\n                      className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                    />\n                  </label>\n                </>\n              )}\n              <label className=\"space-y-2\">\n                Procurement reference\n                <input\n                  value={procurementRef}\n                  onChange={(event) => setProcurementRef(event.target.value)}\n                  className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                />\n              </label>\n              <label className=\"space-y-2\">\n                PO reference\n                <input\n                  value={purchaseOrderRef}\n                  onChange={(event) => setPurchaseOrderRef(event.target.value)}\n                  className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                />\n              </label>\n              <label className=\"space-y-2\">\n                Cost center\n                <input\n                  value={costCenter}\n                  onChange={(event) => setCostCenter(event.target.value)}\n                  className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                />\n              </label>\n              <label className=\"space-y-2\">\n                Reason for change\n                <textarea\n                  value={reason}\n                  onChange={(event) => setReason(event.target.value)}\n                  rows={3}\n                  className=\"w-full rounded-xl border border-line bg-ink px-4 py-2 text-ash\"\n                  placeholder=\"Why is this correction needed?\"\n                />\n              </label>\n\n              {requiresCr && (\n                <div className=\"rounded-xl border border-line/80 bg-soft px-4 py-3 text-xs text-muted\">\n                  This change requires a Change Request before it can be applied.\n                </div>\n              )}\n\n              {message && (\n                <p\n                  className={`text-xs ${\n                    status === \"error\" ? \"text-[#E5A4A4]\" : \"text-ash\"\n                  }`}\n                >\n                  {message}\n                </p>\n              )}\n\n              <div className=\"flex flex-wrap items-center gap-3\">\n                <button\n                  type=\"submit\"\n                  disabled={status === \"loading\"}\n                  className=\"btn-animate btn-primary rounded-full px-4 py-2 text-xs uppercase tracking-[0.2em]\"\n                >\n                  {status === \"loading\" ? \"Saving\" : \"Submit edit\"}\n                </button>\n                {requiresCr && editEventId && (\n                  <Link\n                    href={changeRequestLink}\n                    className=\"btn-animate btn-secondary rounded-full px-4 py-2 text-xs uppercase tracking-[0.2em]\"\n                  >\n                    Create Change Request\n                  </Link>\n                )}\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 638, "column": 0}, "map": {"version":3,"sources":["file:///Users/adamkarllucien/Lucien_technology/lucien.technology/components/portal/ArchiveDocumentButton.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { Icon } from \"@/components/icons/Icon\";\n\ntype ArchiveDocumentButtonProps = {\n  documentId: string;\n};\n\nexport function ArchiveDocumentButton({ documentId }: ArchiveDocumentButtonProps) {\n  const router = useRouter();\n  const [open, setOpen] = useState(false);\n  const [reason, setReason] = useState(\"\");\n  const [status, setStatus] = useState<\"idle\" | \"loading\" | \"error\">(\"idle\");\n  const [message, setMessage] = useState<string | null>(null);\n\n  const submitArchive = async () => {\n    if (reason.trim().length < 5) {\n      setMessage(\"Provide a short reason.\");\n      setStatus(\"error\");\n      return;\n    }\n    setStatus(\"loading\");\n    setMessage(null);\n    try {\n      const response = await fetch(`/api/portal/documents/${documentId}/archive`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ reason: reason.trim() }),\n      });\n      if (!response.ok) {\n        const data = await response.json().catch(() => null);\n        setMessage(data?.error ?? \"Archive failed.\");\n        setStatus(\"error\");\n        return;\n      }\n      setOpen(false);\n      setReason(\"\");\n      setStatus(\"idle\");\n      router.refresh();\n    } catch {\n      setMessage(\"Archive failed.\");\n      setStatus(\"error\");\n    }\n  };\n\n  return (\n    <div className=\"relative\">\n      <button\n        type=\"button\"\n        onClick={() => setOpen((prev) => !prev)}\n        className=\"btn-animate btn-secondary inline-flex items-center gap-2 rounded-full px-3 py-1 text-[0.65rem] uppercase tracking-[0.2em]\"\n      >\n        <Icon name=\"archive\" size={14} strokeWidth={1.25} entrance={false} />\n        Archive\n      </button>\n      {open && (\n        <div className=\"absolute right-0 top-9 z-20 w-64 rounded-xl border border-line/80 bg-ink p-3 text-xs text-muted shadow-lg\">\n          <div className=\"space-y-2\">\n            <div className=\"text-[0.6rem] uppercase tracking-[0.2em] text-slate\">\n              Archive reason\n            </div>\n            <textarea\n              value={reason}\n              onChange={(event) => setReason(event.target.value)}\n              rows={3}\n              className=\"w-full rounded-lg border border-line bg-ink px-2 py-1 text-ash\"\n              placeholder=\"Why is this document archived?\"\n            />\n            {message && <p className=\"text-[#E5A4A4]\">{message}</p>}\n            <button\n              type=\"button\"\n              onClick={submitArchive}\n              disabled={status === \"loading\"}\n              className=\"btn-animate btn-primary inline-flex w-full items-center justify-center gap-2 rounded-full px-3 py-1 text-[0.65rem] uppercase tracking-[0.2em]\"\n            >\n              <Icon\n                name=\"archive\"\n                size={14}\n                strokeWidth={1.25}\n                entrance={false}\n              />\n              {status === \"loading\" ? \"Archiving\" : \"Confirm archive\"}\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAUO,SAAS,sBAAsB,EAAE,UAAU,EAA8B;IAC9E,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAA+B;IACnE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAgB;IAEtD,MAAM,gBAAgB;QACpB,IAAI,OAAO,IAAI,GAAG,MAAM,GAAG,GAAG;YAC5B,WAAW;YACX,UAAU;YACV;QACF;QACA,UAAU;QACV,WAAW;QACX,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,CAAC,sBAAsB,EAAE,WAAW,QAAQ,CAAC,EAAE;gBAC1E,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,QAAQ,OAAO,IAAI;gBAAG;YAC/C;YACA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,OAAO,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM;gBAC/C,WAAW,MAAM,SAAS;gBAC1B,UAAU;gBACV;YACF;YACA,QAAQ;YACR,UAAU;YACV,UAAU;YACV,OAAO,OAAO;QAChB,EAAE,OAAM;YACN,WAAW;YACX,UAAU;QACZ;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,MAAK;gBACL,SAAS,IAAM,QAAQ,CAAC,OAAS,CAAC;gBAClC,WAAU;;kCAEV,8OAAC,oIAAI;wBAAC,MAAK;wBAAU,MAAM;wBAAI,aAAa;wBAAM,UAAU;;;;;;oBAAS;;;;;;;YAGtE,sBACC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCAAsD;;;;;;sCAGrE,8OAAC;4BACC,OAAO;4BACP,UAAU,CAAC,QAAU,UAAU,MAAM,MAAM,CAAC,KAAK;4BACjD,MAAM;4BACN,WAAU;4BACV,aAAY;;;;;;wBAEb,yBAAW,8OAAC;4BAAE,WAAU;sCAAkB;;;;;;sCAC3C,8OAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU,WAAW;4BACrB,WAAU;;8CAEV,8OAAC,oIAAI;oCACH,MAAK;oCACL,MAAM;oCACN,aAAa;oCACb,UAAU;;;;;;gCAEX,WAAW,YAAY,cAAc;;;;;;;;;;;;;;;;;;;;;;;;AAOpD"}}]
}